function getStreamFromBuffer(e){var t=new Stream.Readable;return t._read=function(){t.push(new Buffer(e)),t._read=t.push.bind(t,null)},t}function getInsertString(e,t){return typeof e=="function"?e(t):e}var Stream=require("readable-stream"),StreamQueue=require("streamqueue");exports.prepend=function(e){var t=new Stream.Transform({objectMode:!0});return t._transform=function(t,n,r){if(t.isNull())return r(null,t);var i=new Buffer(getInsertString(e,t));if(t.isStream())return t.contents=new StreamQueue(getStreamFromBuffer(i),t.contents),r(null,t);t.contents=Buffer.concat([i,t.contents],i.length+t.contents.length),r(null,t)},t},exports.append=function(e){var t=new Stream.Transform({objectMode:!0});return t._transform=function(t,n,r){if(t.isNull())return r(null,t);var i=new Buffer(getInsertString(e,t));if(t.isStream())return t.contents=new StreamQueue(t.contents,getStreamFromBuffer(i)),r(null,t);t.contents=Buffer.concat([t.contents,i],i.length+t.contents.length),r(null,t)},t},exports.wrap=function(e,t){var n=new Stream.Transform({objectMode:!0});return n._transform=function(n,r,i){if(n.isNull())return i(null,n);var s=new Buffer(getInsertString(e,n)),o=new Buffer(getInsertString(t,n));if(n.isStream())return n.contents=new StreamQueue(getStreamFromBuffer(s),n.contents,getStreamFromBuffer(o)),i(null,n);n.contents=Buffer.concat([s,n.contents,o],o.length+n.contents.length+s.length),i(null,n)},n},exports.transform=function(e){var t=new Stream.Transform({objectMode:!0});return t._transform=function(t,n,r){if(t.isNull())return r(null,t);if(t.isStream())return t.contents=t.contents.pipe(new Stream.Transform),t.contents._transform=function(n,r,i){i(null,new Buffer(e(n.toString(),t)))},r(null,t);t.contents=new Buffer(e(t.contents.toString(),t)),r(null,t)},t};