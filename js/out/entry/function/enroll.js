define(["jquery","prompt","utility"],function(e,t){function n(r,i){this.opts=e.extend({},n.DEFAULT,i),this.len=this.opts.reg.length;var s=this,o=this.opts.reg,u=this.opts.msg;r.on("focus",function(){e(this).removeClass("error"),e(this).attr("data-iden","1")}),r.on("blur",function(){var n=e(this).val();if(n==null||n=="")return t.changeInfo("输入不能为空"),r.addClass("error"),e(this).attr("data-iden","0"),!1;for(var i=0;i<s.len;i++)if(!o[i].test(n))return t.changeInfo(u[0]),r.addClass("error"),e(this).attr("data-iden","0"),!1;s.override&&sendAjax({url:s.opts.url,success:function(i){i.success?(e(this).removeClass("error"),e(this).attr("data-iden","1")):(t.changeInfo("用户名已存在"),r.addClass("error"),e(this).attr("data-iden","0"))}})})}function r(t){t.on("focus",function(){e(this).removeClass("error"),e(this).attr("data-iden","1")})}n.DEFAULT={reg:[],msg:[],override:!1,url:""},t=new t.Prompt({prompt:e(".prompt")}),e.fn.extend({enroll:function(r){return this.each(function(){new n(e(this),r)})},inputFocus:function(){return this.each(function(){new r(e(this))})}})});