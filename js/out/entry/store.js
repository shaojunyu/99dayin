require.config({baseUrl:"./js",paths:{jquery:"lib/jQuery",scroll:"lib/iscroll",modal:"lib/jquery.simplemodal",utility:"entry/utility/utility",checkEvent:"entry/function/checkAll",prompt:"entry/function/prompt"}}),require(["jquery","scroll","checkEvent","prompt","modal","utility"],function(e,t,n,r,i){var s=bindScroll(e(".files"));e(".basic-btn").on("click",function(t){var n=e(t.target),r=n.attr("id"),i=e("#change-ps-page"),s=e("#withdraw-page");r==="withdraw"?toggleShow(s):r==="changePs"&&toggleShow(i)}),r=new r.Prompt({prompt:e(".prompt")}),e('[type="checkbox"]').attr("checked",!1),new n.Check({container:e("#delivery-orders"),checkAll:e(".select-all-btn input"),checkBtns:e("#delivery-orders :checkbox"),className:"order-checkbox"}),setInterval(function(){e(".setTime").each(function(){e(this).text(e(this).text()-1)})},6e4),e(".back").on("click",function(){var t=e(this).parents(".left-part");toggleShow(t)});var o={amount:e(".withdraw-input"),confirm:e(".withdraw-confir"),pre_WD:e(".pre-withdraw"),WDed:e(".withdrawed"),total:e(".total"),calMoney:function(t){this.pre_WD.val(this.pre_WD.val()-t),this.WDed.val(this.WDed.val()+t),this.total.val(this.total.val()+t)},init:function(){var n=this;this.confirm.on("click",function(){var t=Number(n.amount.val()),i=[/^\d+$/,/^[0-9]+(.[0-9]{1})?$/];t===0||t==null?r.changeInfo("输入不能为空!"):!i[0].test(t)&&!i[1].test(t)?r.changeInfo("输入金额不正确，只能带有一位小数!"):e.ajax({url:Pathurl.withdraw,data:{money:t}}).done(function(e){e.success&&n.calMoney(t),r.changeInfo(e.msg)}).fail(function(){r.changeInfo("为什么会出错勒~~~")})})}};o.init();var u={oldPs:e(".old-ps"),newPs:e(".new-ps"),confir:e(".confir-ps"),promptPs:e(".prompt-ps"),init:function(){var t=this;this.promptPs.on("click",function(){var e=t.oldPs.val(),n=t.newPs.val(),i=t.confir.val(),s=/^[a-zA-Z]\w*$/;e==""||e==null||n==""||n==null||i==null||i==""?r.changeInfo("输入不能为空,请先输入!"):s.test(n)?r.changeInfo("密码以字母开头，只能包含字母,数字,下划线!"):e===i?r.changeInfo("两次密码输入不一致!"):sendAjax({url:Pathurl.promptPs,data:{oldPs:e,newPs:n},success:function(n){n.success&&(t.promptPs.parents(".change-ps").hide(),r.changeInfo("密码修改成功!"))}})})}};u.init();var a={order:e(".order-header"),delivery_btn:e(".order-header .delivery"),pickup_btn:e(".order-header .pickup"),delivery:e("#delivery-orders"),pickup:e("#pickup-orders"),delivery_ul:e("#delivery-orders ul"),pickup_ul:e("#pickup-orders ul"),log:e("#view-log"),withdraw_log:e(".record"),changeOrder:function(){var n=this;this.order.on("click",function(t){var r=e(t.target);r.hasClass("delivery")?(changeShow(n.delivery,n.pickup),changeClass(r,"active"),refreshScroll(s)):r.hasClass("pickup")&&(changeShow(n.pickup,n.delivery),changeClass(r,"active"),refreshScroll(s))})},refreshOrder:function(){var n=this;e.when(e.ajax({url:Pathurl.delivery,data:{order:"delivery"}}),e.ajax({url:Pathurl.pickup,data:{order:"pickup"}})).then(function(e,t){e.success&&n.addLi(n.delivery_ul,e.data,n.delivery_btn),t.success&&n.addLi(n.pickup_ul,t.data,n.pickup_ul)}),setTimeout(arguments.callee,1e4)},showLog:function(){var t=this;this.log.on("click",function(){openModal(t.withdraw_log,!0)})},addLi:function(t,n,r){var i=document.createElement("li"),s="",o=Number(r.attr("data-order"));r.attr("data-order",o),n.forEach(function(e,t){s+='<div class="order-upart"><input class="order-checkbox sub-checkbox" type="checkbox" name="order" data-num='+(t+1)+">"+"<div>订单编号:<span>"+e.orderNum+"</span></div>"+"<div>收货地址:"+e.address+"</div>"+"<div><span>文件信息:</span>"+'<div class="file-info">'+"<header><span>序号</span>"+"<span>文件名</span>"+"<span>单/双面</span>"+"<span>横/竖</span>"+"<span>每页PPT数量</span>"+"<span>大小</span>"+"<span>份数</span>"+"</header>"+'<div class="container files" id="warpper'+(t+1)+'">'+'<article id="scroller">'+function(e){var t="";return e.forEach(function(e,n){t+='<div class="row" data-num="'+(n+1)+'">'+"<span>"+(n+1)+"</span>"+'<span><i class="'+e.classname+'"></i>'+e.name+"</span>"+"<span>"+e.pages+"</span>"+"<span>"+e.directino+"</span>"+"<span>"+e.ppt?e.ppt:"0</span><span>"+e.size+"</span>"+"<span>"+e.copies+"</span>"+"</div>"}),t}(e.orders)+"</article>"+"</div>"+"</div>"+"</div>"+"</div>"+'<div class="summary">'+'<div class="summary-info">'+"总价：<span>"+e.money+"￥</span> 收货方式："+"<span>"+e.delivery+"</span> 支付状态："+" <span>未支付</span>"+'<i>剩余时间:<span class="setTime">30</span>分</i>'+"</div>"+'<img src="img/divided.png">'+" </div>"}),i.innerHTML=s,t.append(i)},init:function(){this.changeOrder(),this.showLog()}};a.init()});